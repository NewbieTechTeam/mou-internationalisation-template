import{a as G,b as F,c as B}from"./chunk-JKV52MIM.js";import{Bb as U,Hb as D,Sb as N,ec as _,fc as I,hc as W,ic as Z,qc as P,qd as j,r as X}from"./chunk-UCKNCWZ3.js";import{$b as d,Ac as x,Ca as f,Da as Y,Hc as p,Ic as g,Mb as V,Na as b,Oa as v,Ob as J,Zb as e,_b as s,dc as M,gc as c,ic as y,ma as O,p as H,pd as K,rc as $,sa as L,sb as l,sc as i,sd as Q,tc as S,uc as q,ud as T,wc as E,xa as m,xc as w,yc as A,zd as k}from"./chunk-EW3RQAEJ.js";var ee=(()=>{let r=class r{constructor(){this.rolesSrv=m(I),this.permissionsSrv=m(_),this.firebasePermissionsSrv=m(j),this.currentRole="",this.currentPermissions=[],this.permissionsOfRole={ADMIN:["canAdd","canDelete","canEdit","canRead"],MANAGER:["canAdd","canEdit","canRead"],GUEST:["canRead"]},this._destroy$=new H}ngOnInit(){this.currentRole=Object.keys(this.rolesSrv.getRoles())[0],this.currentPermissions=Object.keys(this.permissionsSrv.getPermissions()),console.log("this.currentRole"),console.log(this.currentRole),this.rolesSrv.roles$.pipe(O(this._destroy$)).subscribe(n=>{console.log(n)}),this.permissionsSrv.permissions$.pipe(O(this._destroy$)).subscribe(n=>{console.log(n)})}ngOnDestroy(){this._destroy$.next(),this._destroy$.complete()}onPermissionChange(){this.currentPermissions=this.permissionsOfRole[this.currentRole],this.rolesSrv.flushRolesAndPermissions(),console.log(this.currentRole),console.log("this.currentRole"),this.rolesSrv.addRoleWithPermissions(this.currentRole,this.currentPermissions)}};r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=f({type:r,selectors:[["app-permissions-role-switching"]],standalone:!0,features:[x],decls:24,vars:7,consts:[["href","https://github.com/AlexKhymenko/ngx-permissions","target","_blank"],[3,"ngModelChange","change","ngModel"],["value","ADMIN"],["value","MANAGER"],["value","GUEST"]],template:function(t,o){t&1&&(d(0,"page-header"),e(1,"p"),i(2," The permissions management is powered by "),e(3,"a",0)(4,"code"),i(5,"ngx-permissions"),s()(),i(6,`.
`),s(),e(7,"mat-button-toggle-group",1),A("ngModelChange",function(u){return w(o.currentRole,u)||(o.currentRole=u),u}),c("change",function(){return o.onPermissionChange()}),e(8,"mat-button-toggle",2),i(9,"ADMIN"),s(),e(10,"mat-button-toggle",3),i(11,"MANAGER"),s(),e(12,"mat-button-toggle",4),i(13,"GUEST"),s()(),e(14,"p"),i(15," Your current role: "),e(16,"code"),i(17),p(18,"json"),s()(),e(19,"p"),i(20," Your current permissions: "),e(21,"code"),i(22),p(23,"json"),s()()),t&2&&(l(7),E("ngModel",o.currentRole),l(10),S(g(18,3,o.currentRole)),l(5),S(g(23,5,o.currentPermissions)))},dependencies:[T,N,U,D,B,G,F,P]});let a=r;return a})();var te=(()=>{let r=class r{constructor(){this.router=m(X),this.rolesSrv=m(I),this.permissionsSrv=m(_),this.currentRole="",this.currentPermissions=[],this.permissionsOfRole={ADMIN:["canAdd","canDelete","canEdit","canRead"],MANAGER:["canAdd","canEdit","canRead"],GUEST:["canRead"]}}ngOnInit(){this.currentRole=Object.keys(this.rolesSrv.getRoles())[0],console.log("this.currentRole"),console.log(this.currentRole),this.currentPermissions=Object.keys(this.permissionsSrv.getPermissions())}onPermissionChange(){this.currentPermissions=this.permissionsOfRole[this.currentRole],this.rolesSrv.flushRolesAndPermissions(),this.rolesSrv.addRoleWithPermissions(this.currentRole,this.currentPermissions),console.log("this.currentRole"),console.log(this.currentRole),this.router.navigateByUrl("/dashboard")}};r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=f({type:r,selectors:[["app-permissions-route-guard"]],standalone:!0,features:[x],decls:20,vars:7,consts:[[3,"ngModelChange","change","ngModel"],["value","ADMIN"],["value","MANAGER"],["value","GUEST"]],template:function(t,o){t&1&&(d(0,"page-header"),e(1,"p"),i(2,` The route will be redirected to dashboard after change permission.
`),s(),e(3,"mat-button-toggle-group",0),A("ngModelChange",function(u){return w(o.currentRole,u)||(o.currentRole=u),u}),c("change",function(){return o.onPermissionChange()}),e(4,"mat-button-toggle",1),i(5,"ADMIN"),s(),e(6,"mat-button-toggle",2),i(7,"MANAGER"),s(),e(8,"mat-button-toggle",3),i(9,"GUEST"),s()(),e(10,"p"),i(11," Your current role: "),e(12,"code"),i(13),p(14,"json"),s()(),e(15,"p"),i(16," Your current permissions: "),e(17,"code"),i(18),p(19,"json"),s()()),t&2&&(l(3),E("ngModel",o.currentRole),l(10),S(g(14,3,o.currentRole)),l(5),S(g(19,5,o.currentPermissions)))},dependencies:[T,N,U,D,B,G,F,P]});let a=r;return a})();var ie=(()=>{let r=class r{};r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=Y({type:r}),r.\u0275inj=L({imports:[k]});let a=r;return a})();function ae(a,r){if(a&1){let R=M();e(0,"li"),i(1),e(2,"button",2),c("click",function(){let t=b(R).$implicit,o=y();return v(o.adjustUserPermissions(t,"ADMIN"))}),i(3,"Set Admin"),s(),e(4,"button",2),c("click",function(){let t=b(R).$implicit,o=y();return v(o.adjustUserPermissions(t,"MANAGER"))}),i(5,"Set Manager"),s(),e(6,"button",2),c("click",function(){let t=b(R).$implicit,o=y();return v(o.adjustUserPermissions(t,"GUEST"))}),i(7,"Set Guest"),s()()}if(a&2){let R=r.$implicit;l(),q(" ",R.email," ")}}var re=(()=>{let r=class r{constructor(){this.permissionsSrv=m(_),this.firebasePermissionsSrv=m(j),this.comparedPermission=["guest"]}ngOnInit(){this.loadUsers()}loadUsers(){this.users$=this.firebasePermissionsSrv.getAllUsers()}getPermissions(){return Object.keys(this.permissionsSrv.getPermissions())}addPermission(){this.permissionsSrv.addPermission("admin",()=>new Promise((n,t)=>{setTimeout(()=>n(!0),2e3)}))}removePermission(){this.permissionsSrv.removePermission("admin")}unAuthorized(){console.log("unAuthorized")}authorized(){console.log("authorizes")}changeToAdmin(){this.comparedPermission=["admin"],console.log(this.comparedPermission)}changeToAnotherPermission(){this.comparedPermission=["awesome"],console.log(this.comparedPermission)}changeToGuest(){this.comparedPermission=["guest"],console.log(this.comparedPermission)}createUser(n,t){let o=this.firebasePermissionsSrv.auth.currentUser;if(o){let h=o.email||"";this.firebasePermissionsSrv.createUser(n,t,h,"1tlcone").subscribe(()=>{console.log("User created successfully."),this.loadUsers()},C=>{console.error("Error creating user 1:",C)})}else console.error("No authenticated user found.")}adjustUserPermissions(n,t){this.firebasePermissionsSrv.adjustUserPermissions(n.uid,t).subscribe(()=>{this.users$=this.firebasePermissionsSrv.getAllUsers()})}adjustUserPermissions2(n,t){console.log({permission:t}),n.permissions.includes(t)?n.permissions=n.permissions.filter(o=>o!==t):n.permissions.push(t),this.firebasePermissionsSrv.setUserPermissions(n.uid,n.permissions).subscribe(()=>{this.loadUsers()})}};r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=f({type:r,selectors:[["app-permissions-test"]],standalone:!0,features:[x],decls:22,vars:3,consts:[["emailInput",""],["passwordInput",""],[3,"click"],["type","email","required",""],["type","password","required",""],[4,"ngFor","ngForOf"]],template:function(t,o){if(t&1){let h=M();d(0,"page-header"),e(1,"div")(2,"h2"),i(3,"Create User"),s(),e(4,"button",2),c("click",function(){b(h);let C=$(10),oe=$(15);return v(o.createUser(C.value,oe.value))}),i(5,"Create User"),s(),d(6,"br"),e(7,"label"),i(8,"Email:"),s(),d(9,"input",3,0)(11,"br"),e(12,"label"),i(13,"Password:"),s(),d(14,"input",4,1),s(),e(16,"div")(17,"h2"),i(18,"List of Users"),s(),e(19,"ul"),V(20,ae,8,1,"li",5),p(21,"async"),s()()}t&2&&(l(20),J("ngForOf",g(21,1,o.users$)))},dependencies:[ie,Z,P,k,K,Q]});let a=r;return a})();var Ze=[{path:"role-switching",component:ee},{path:"route-guard",component:te,canActivate:[W],data:{permissions:{except:"GUEST",redirectTo:"/dashboard"}}},{path:"test",component:re,canActivate:[W],data:{permissions:{only:"ADMIN",redirectTo:"/dashboard"}}}];export{Ze as routes};

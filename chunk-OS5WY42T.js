import{a as I,b as G,c as F}from"./chunk-DAE74Q73.js";import{Bb as k,Hb as O,Sb as U,ec as v,fc as D,hc as W,ic as X,qc as N,qd as j,r as Q}from"./chunk-WMTJWOQX.js";import{$b as x,Ac as b,Ad as A,Ca as f,Da as Y,Hc as u,Ic as g,Mb as V,Na as _,Oa as P,Ob as J,Zb as e,_b as o,dc as y,gc as m,ic as M,ma as B,p as H,pd as q,rc as $,sa as L,sb as l,sc as i,sd as K,tc as p,vd as T,wc as R,xa as c,xc as E,yc as w}from"./chunk-VRKKC5PY.js";var Z=(()=>{let n=class n{constructor(){this.rolesSrv=c(D),this.permissionsSrv=c(v),this.firebasePermissionsSrv=c(j),this.currentRole="",this.currentPermissions=[],this.permissionsOfRole={ADMIN:["canAdd","canDelete","canEdit","canRead"],MANAGER:["canAdd","canEdit","canRead"],GUEST:["canRead"]},this._destroy$=new H}ngOnInit(){this.currentRole=Object.keys(this.rolesSrv.getRoles())[0],this.currentPermissions=Object.keys(this.permissionsSrv.getPermissions()),console.log("this.currentRole"),console.log(this.currentRole),this.rolesSrv.roles$.pipe(B(this._destroy$)).subscribe(s=>{console.log(s)}),this.permissionsSrv.permissions$.pipe(B(this._destroy$)).subscribe(s=>{console.log(s)})}ngOnDestroy(){this._destroy$.next(),this._destroy$.complete()}onPermissionChange(){this.currentPermissions=this.permissionsOfRole[this.currentRole],this.rolesSrv.flushRolesAndPermissions(),console.log(this.currentRole),console.log("this.currentRole"),this.rolesSrv.addRoleWithPermissions(this.currentRole,this.currentPermissions)}};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=f({type:n,selectors:[["app-permissions-role-switching"]],standalone:!0,features:[b],decls:24,vars:7,consts:[["href","https://github.com/AlexKhymenko/ngx-permissions","target","_blank"],[3,"ngModelChange","change","ngModel"],["value","ADMIN"],["value","MANAGER"],["value","GUEST"]],template:function(t,r){t&1&&(x(0,"page-header"),e(1,"p"),i(2," The permissions management is powered by "),e(3,"a",0)(4,"code"),i(5,"ngx-permissions"),o()(),i(6,`.
`),o(),e(7,"mat-button-toggle-group",1),w("ngModelChange",function(d){return E(r.currentRole,d)||(r.currentRole=d),d}),m("change",function(){return r.onPermissionChange()}),e(8,"mat-button-toggle",2),i(9,"ADMIN"),o(),e(10,"mat-button-toggle",3),i(11,"MANAGER"),o(),e(12,"mat-button-toggle",4),i(13,"GUEST"),o()(),e(14,"p"),i(15," Your current role: "),e(16,"code"),i(17),u(18,"json"),o()(),e(19,"p"),i(20," Your current permissions: "),e(21,"code"),i(22),u(23,"json"),o()()),t&2&&(l(7),R("ngModel",r.currentRole),l(10),p(g(18,3,r.currentRole)),l(5),p(g(23,5,r.currentPermissions)))},dependencies:[T,U,k,O,F,I,G,N]});let a=n;return a})();var ee=(()=>{let n=class n{constructor(){this.router=c(Q),this.rolesSrv=c(D),this.permissionsSrv=c(v),this.currentRole="",this.currentPermissions=[],this.permissionsOfRole={ADMIN:["canAdd","canDelete","canEdit","canRead"],MANAGER:["canAdd","canEdit","canRead"],GUEST:["canRead"]}}ngOnInit(){this.currentRole=Object.keys(this.rolesSrv.getRoles())[0],console.log("this.currentRole"),console.log(this.currentRole),this.currentPermissions=Object.keys(this.permissionsSrv.getPermissions())}onPermissionChange(){this.currentPermissions=this.permissionsOfRole[this.currentRole],this.rolesSrv.flushRolesAndPermissions(),this.rolesSrv.addRoleWithPermissions(this.currentRole,this.currentPermissions),console.log("this.currentRole"),console.log(this.currentRole),this.router.navigateByUrl("/dashboard")}};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=f({type:n,selectors:[["app-permissions-route-guard"]],standalone:!0,features:[b],decls:20,vars:7,consts:[[3,"ngModelChange","change","ngModel"],["value","ADMIN"],["value","MANAGER"],["value","GUEST"]],template:function(t,r){t&1&&(x(0,"page-header"),e(1,"p"),i(2,` The route will be redirected to dashboard after change permission.
`),o(),e(3,"mat-button-toggle-group",0),w("ngModelChange",function(d){return E(r.currentRole,d)||(r.currentRole=d),d}),m("change",function(){return r.onPermissionChange()}),e(4,"mat-button-toggle",1),i(5,"ADMIN"),o(),e(6,"mat-button-toggle",2),i(7,"MANAGER"),o(),e(8,"mat-button-toggle",3),i(9,"GUEST"),o()(),e(10,"p"),i(11," Your current role: "),e(12,"code"),i(13),u(14,"json"),o()(),e(15,"p"),i(16," Your current permissions: "),e(17,"code"),i(18),u(19,"json"),o()()),t&2&&(l(3),R("ngModel",r.currentRole),l(10),p(g(14,3,r.currentRole)),l(5),p(g(19,5,r.currentPermissions)))},dependencies:[T,U,k,O,F,I,G,N]});let a=n;return a})();var te=(()=>{let n=class n{};n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Y({type:n}),n.\u0275inj=L({imports:[A]});let a=n;return a})();function se(a,n){if(a&1){let S=y();e(0,"li")(1,"span"),i(2),o(),e(3,"div",11)(4,"button",12),m("click",function(){let t=_(S).$implicit,r=M();return P(r.adjustUserPermissions(t,"ADMIN"))}),i(5,"Set Admin"),o(),e(6,"button",13),m("click",function(){let t=_(S).$implicit,r=M();return P(r.adjustUserPermissions(t,"MANAGER"))}),i(7,"Set Manager"),o(),e(8,"button",14),m("click",function(){let t=_(S).$implicit,r=M();return P(r.adjustUserPermissions(t,"GUEST"))}),i(9,"Set Guest"),o()()()}if(a&2){let S=n.$implicit;l(2),p(S.email)}}var ie=(()=>{let n=class n{constructor(){this.permissionsSrv=c(v),this.firebasePermissionsSrv=c(j),this.comparedPermission=["guest"]}ngOnInit(){this.loadUsers()}loadUsers(){this.users$=this.firebasePermissionsSrv.getAllUsers()}getPermissions(){return Object.keys(this.permissionsSrv.getPermissions())}addPermission(){this.permissionsSrv.addPermission("admin",()=>new Promise((s,t)=>{setTimeout(()=>s(!0),2e3)}))}removePermission(){this.permissionsSrv.removePermission("admin")}unAuthorized(){console.log("unAuthorized")}authorized(){console.log("authorizes")}changeToAdmin(){this.comparedPermission=["admin"],console.log(this.comparedPermission)}changeToAnotherPermission(){this.comparedPermission=["awesome"],console.log(this.comparedPermission)}changeToGuest(){this.comparedPermission=["guest"],console.log(this.comparedPermission)}createUser(s,t){let r=this.firebasePermissionsSrv.auth.currentUser;if(r){let h=r.email||"";this.firebasePermissionsSrv.createUser(s,t,h,"1tlcone").subscribe(()=>{console.log("User created successfully."),this.loadUsers()},C=>{console.error("Error creating user 1:",C)})}else console.error("No authenticated user found.")}adjustUserPermissions(s,t){this.firebasePermissionsSrv.adjustUserPermissions(s.uid,t).subscribe(()=>{this.users$=this.firebasePermissionsSrv.getAllUsers()})}adjustUserPermissions2(s,t){console.log({permission:t}),s.permissions.includes(t)?s.permissions=s.permissions.filter(r=>r!==t):s.permissions.push(t),this.firebasePermissionsSrv.setUserPermissions(s.uid,s.permissions).subscribe(()=>{this.loadUsers()})}};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=f({type:n,selectors:[["app-permissions-test"]],standalone:!0,features:[b],decls:22,vars:3,consts:[["emailInput",""],["passwordInput",""],[1,"container"],[1,"create-user-section"],[1,"input-group"],["type","email","required",""],["type","password","required",""],[1,"btn-create-user",3,"click"],[1,"list-users-section"],[1,"user-list"],[4,"ngFor","ngForOf"],[1,"btn-group"],[1,"btn-set-admin",3,"click"],[1,"btn-set-manager",3,"click"],[1,"btn-set-guest",3,"click"]],template:function(t,r){if(t&1){let h=y();e(0,"div",2)(1,"div",3)(2,"h2"),i(3,"Create User"),o(),e(4,"div",4)(5,"label"),i(6,"Email:"),o(),x(7,"input",5,0),o(),e(9,"div",4)(10,"label"),i(11,"Password:"),o(),x(12,"input",6,1),o(),e(14,"button",7),m("click",function(){_(h);let C=$(8),ne=$(13);return P(r.createUser(C.value,ne.value))}),i(15,"Create User"),o()(),e(16,"div",8)(17,"h2"),i(18,"List of Users"),o(),e(19,"ul",9),V(20,se,10,1,"li",10),u(21,"async"),o()()()}t&2&&(l(20),J("ngForOf",g(21,1,r.users$)))},dependencies:[te,X,A,q,K],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.create-user-section[_ngcontent-%COMP%], .list-users-section[_ngcontent-%COMP%]{width:80%;padding:16px;margin-bottom:24px;border-radius:8px;box-shadow:0 2px 4px #0000001a}.create-user-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .list-users-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:12px;font-size:20px}.input-group[_ngcontent-%COMP%]{margin-bottom:12px}.input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:4px}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:8px;border:1px solid #ccc;border-radius:4px}.btn-create-user[_ngcontent-%COMP%], .btn-set-admin[_ngcontent-%COMP%], .btn-set-manager[_ngcontent-%COMP%], .btn-set-guest[_ngcontent-%COMP%]{padding:10px 20px;margin-right:8px;cursor:pointer;background-color:#3f51b5;border:none;border-radius:4px}.btn-group[_ngcontent-%COMP%]{margin-top:8px}.user-list[_ngcontent-%COMP%]{padding:0;list-style:none}.user-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid #ccc}.user-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{border-bottom:none}"]});let a=n;return a})();var Ze=[{path:"role-switching",component:Z},{path:"route-guard",component:ee,canActivate:[W],data:{permissions:{except:"GUEST",redirectTo:"/dashboard"}}},{path:"test",component:ie,canActivate:[W],data:{permissions:{except:"GUEST",redirectTo:"/dashboard"}}}];export{Ze as routes};
